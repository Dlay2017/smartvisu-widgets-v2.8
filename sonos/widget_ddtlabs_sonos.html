/**
* Sonos(r) Multimedia Player
*
* @param id:       unique id for this widget
* @param gad:      gad name
* @param speakers: 2D array of speaker names / icons. eg: [['airplay1','scene_livingroom.svg'],['airplay2','scene_cooking.svg'],['airplay3','scene_sleeping.svg']]
* @param playlist: show button for playlist, 0/1: default 0, optional
* @param pos:      show slider, 0/1: default 1, optional
* @param mute:     show button for mute, 0/1: default 1, optional
* @author dev0
*/

{% macro sonos(id, gad) %}

	{% import "basic.html" as basic %}
	{% import "widget_ddtlabs_sonos.html" as ddtlabs_sonos %}
	{% import "widget_selectmenu.html" as selectmenu %}


	{% set uid = uid(page, id) %}

	{% set prefix = 'mm_' %}
	{% set volume    = '.volume' %}
	{% set cover_url 		= '.currentAlbumArtURL' %}
	{% set currentArtist    = '.currentArtist' %}
	{% set currentTitle    = '.currentTitle' %}
	{% set currentAlbum    = '.currentAlbum' %}
	{% set currentTrackDuration    = '.currentTrackDuration' %}
	{% set pos    = '.currentTrackPosition' %}
	{% set radioSender    = '.currentSender' %}
	{% set radioShow    = '.currentSenderCurrent' %}
	{% set radioInfo    = '.currentSenderInfo' %}
	{% set mute    = '.Mute' %}
	{% set repeat    = '.Repeat' %}
	{% set shuffle    = '.Shuffle' %}



<div class="ddtlabs">
<div id="{{ uid }}" class="sonos">

<table width="100%">
<tr>
    <td id="vol" rowspan="5">
    	<div class="vol">
			<img class="slider-bottomup-scale" src="pages/base/pics/scale_buttomup.png">
			{{ basic.slider(id~'_vol', prefix~gad~volume, 0, 100, 1, 'bottomup') }}
		</div>
    </td>

    <td colspan="2" id="spacer"></td>
</tr>

<tr>
    <td id="cover" rowspan="4">
   	{{ ddtlabs_sonos.cover(id~'cover', prefix~gad~cover_url) }}
    </td>
	<td>
		<span class="title">
		{{ basic.value(id~radioSender, prefix~gad~radioSender, '', '') }}
		{{ basic.value(id~currentArtist, prefix~gad~currentArtist, '', '') }}
		</span>
	</td>
</tr>

<tr>
	<td>
		<span class="title">
		{{ basic.value(id~radioShow, prefix~gad~radioShow, '', '') }}
		{{ basic.value(id~currentTitle, prefix~gad~currentTitle, '', '') }} &nbsp;&nbsp;
		[{{ basic.value(id~currentTrackDuration, prefix~gad~currentTrackDuration, '', '') }}]
		</span>
	</td>
</tr>

<tr>
	<td>
		<span class="title">
		{{ basic.value(id~radioInfo, prefix~gad~radioInfo, '', '') }}
		{{ basic.value(id~currentAlbum, prefix~gad~currentAlbum, '', '') }}
		</span>
	</td>
</tr>

<tr>
	<td>
		<div class="pos">
			<div class="scale">
			</div>
			{{ basic.slider(id~'_pos', prefix~gad~pos, 0, 100, 1) }}
		</div>
	</td>
</tr>

<tr>

	<td>
		<div data-role="controlgroup" data-type="horizontal" class="mute">
			{{ basic.dual(id~'mute', prefix~gad~mute, 'audio_volume_mute.svg', 'audio_volume_mid.svg', 1, 0, 'mini') }}
		</div>
	</td>
	<td>
		<div data-role="controlgroup" data-type="horizontal" class="play">
   			{{ basic.button(id~'-prev', prefix~gad, 'Prev', 'control_arrow_left.svg', 'Previous') }}
   			{{ basic.button(id~'-play', prefix~gad, 'Play', 'audio_play.svg', 'Play') }}
   			{{ basic.button(id~'-stop', prefix~gad, 'Stop', 'audio_pause.svg', 'Stop') }}
   			{{ basic.button(id~'-next', prefix~gad, 'Next', 'control_arrow_right.svg', 'Next') }}
		</div>
	</td>
	<td>
		<div class="playlist">
			{{ basic.multistate(id~'-repeat', prefix~gad~repeat, ['0', '1', '2'], ['audio_repeat.svg', 'audio_repeat_song.svg', 'audio_repeat.svg'], 'mini') }}
			{{ basic.dual(id~'-shuffle', prefix~gad~shuffle, 'audio_shuffle.svg', 'audio_shuffle.svg', 1, '') }}
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
   			{{ basic.button(id~'-pl_prev', prefix~gad, 'lPrev', 'audio_rew.svg', '') }}
   			{{ basic.button(id~'-pl_next', prefix~gad, 'lNext', 'audio_ff.svg', '') }}
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			{{ ddtlabs_sonos.selectmenu(id~'-smPlaylist', prefix~gad~playlist, ['Playlists','test1','test2'], '') }}
		</div>
	</td>
</tr>

</table>

</div>
</div>

{% endmacro %}



/**
* Displays the cover-art
*
* @param unique id for this widget
* @param the path/url to the image
*
* @author Roland Unterholzer
*/

{% macro cover(id, src) %}
	<img class="coverimg" id="{{ uid(page, id) }}" data-widget="ddtlabs_sonos.cover" data-item="{{ src }}" src="{{ src|default('pages/base/pics/trans.png') }}" />
{% endmacro %}



{% macro selectmenu(id, gad, items, label) %}
/** <a class="ui-shadow ui-btn-corner-all ui-btn-inline selectmenu"> */
		<select name ="{{ uid(page, id) }}" id="{{ uid(page, id) }}" data-widget="selectmenu.selectmenu" data-item="{{ gad }}" data-native-menu="false" data-placeholder="false" data-mini="true" data-native-menu="false" class="selectmenu"/>
		{% for item in items %}
           	<option>{{ item }}</option>
        {% endfor %}
		</select>

{% endmacro %}
